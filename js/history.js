// поля для запоминанияvar inputFieldsArray = [    "HIGHT_SETS_ID",    "WIDTH_SETS_ID",    "TOTAL_PAINTING_ID",    "MOVABLE_PAINTING_ID",    "NUMBER_OF_DUPLICATOR_ID",    "NUMBER_SETS_ID",    "TYPE_BAFFLE_ID",    "BAFFLE_SEKECTOR_CLASS"];var dataAttributesArray = [    "type",    "price",    "price_in_profil",    "price_in_napolnenii",    "area",    "decor_price",    "karkas_img",    "karkas_name",    "karkas_info",    "karkas_tsvet_uplotnitelya",    "karkas_tsvet_zaglushki",    "karkas_tsvet_zaglushki_tortsevoy",    "karkas_vid_krepleniya",    "karkas_tsvet_uplotnitelya_price",    "karkas_tsvet_zaglushki_price",    "karkas_tsvet_zaglushki_tortsevoy_price",    "karkas_vid_krepleniya_price",    "karkas_price",    "karkas_full_price",    "vertikalnue_pereochki_count",    "vertikalnue_pereochki_img",    "vertikalnue_pereochki_name",    "vertikalnue_pereochki_price",    "vertikalnue_pereochki_price_for_one",    "horizontal_pereochki_count",    "horizontal_pereochki_img",    "horizontal_pereochki_name",    "horizontal_pereochki_price",    "horizontal_pereochki_price_for_one",    "furnitura_razdvizh_mehanizm",    "furnitura_dovodchik",    "furnitura_skladnoi_mehanizm",    "material_1_type",    "material_1_color",    "material_1_width",    "material_1_height",    "material_1_kol",    "material_1_zakalka_stekla",    "material_1_dvoynoe_zapolnenie",    "material_1_tolschina",    "material_1_ploschad",    "material_1_price",    "material_2_type",    "material_2_color",    "material_2_width",    "material_2_height",    "material_2_kol",    "material_2_zakalka_stekla",    "material_2_dvoynoe_zapolnenie",    "material_2_tolschina",    "material_2_ploschad",    "material_2_price",    "material_3_type",    "material_3_color",    "material_3_width",    "material_3_height",    "material_3_kol",    "material_3_zakalka_stekla",    "material_3_dvoynoe_zapolnenie",    "material_3_tolschina",    "material_3_ploschad",    "material_3_price",    "material_4_type",    "material_4_color",    "material_4_width",    "material_4_height",    "material_4_kol",    "material_4_zakalka_stekla",    "material_4_dvoynoe_zapolnenie",    "material_4_tolschina",    "material_4_ploschad",    "material_4_price",    "material_5_type",    "material_5_color",    "material_5_width",    "material_5_height",    "material_5_kol",    "material_5_zakalka_stekla",    "material_5_dvoynoe_zapolnenie",    "material_5_tolschina",    "material_5_ploschad",    "material_5_price"];// поля для запоминания//// инициализация функционала состоянийfunction historyInit () {    if ($('#history').is(':visible')) $('#history').hide();    else {        historyAjax("","{}");        $('#history').show();    }}// инициализация функционала состояний//// список состоянийfunction historyAjax(action,obj) {    $.post("php/history.php",{action:action,obj:obj},function(data){$("#resultHistory").html(data);});}// список состояний//// запомнить состояниеfunction historyAjaxInsert() {    var state1 = window.parent.$("iframe#state1").contents();    var state2 = window.parent.$("iframe#state2").contents();    var state3 = window.parent.$("iframe#state3").contents();    var iObj = new Object();    for (var i = 0; i < inputFieldsArray.length; i++) {        inputFieldsArray[i] == "BAFFLE_SEKECTOR_CLASS" ?            iObj[inputFieldsArray[i]] = state1.find("."+inputFieldsArray[i]).val():            iObj[inputFieldsArray[i]] = state1.find("#"+inputFieldsArray[i]).val();    }    for (var i = 0; i < dataAttributesArray.length; i++) {        iObj[dataAttributesArray[i]+"1"] = state1.find('*[data-id="' + state1.find('.BAFFLE_SEKECTOR_CLASS').val() + '"]').attr('data-' + dataAttributesArray[i].replace(/_/g,"-"));        iObj[dataAttributesArray[i]+"2"] = state2.find('*[data-id="' + state2.find('.BAFFLE_SEKECTOR_CLASS').val() + '"]').attr('data-' + dataAttributesArray[i].replace(/_/g,"-"));        iObj[dataAttributesArray[i]+"3"] = state3.find('*[data-id="' + state3.find('.BAFFLE_SEKECTOR_CLASS').val() + '"]').attr('data-' + dataAttributesArray[i].replace(/_/g,"-"));    }    iObj.comment = prompt("Сохранить вариант под именем:", "No Comments");    historyAjax("insert",JSON.stringify(iObj));}// запомнить состояние//// воспроизвести состояниеfunction historyAjaxApply(action,obj) {    var frame1 = window.frames[0];    var frame2 = window.frames[1];    var frame3 = window.frames[2];    var state1 = window.parent.$('iframe#state1').get(0).contentWindow.$;    var state2 = window.parent.$('iframe#state2').get(0).contentWindow.$;    var state3 = window.parent.$('iframe#state3').get(0).contentWindow.$;    $.post("php/history.php",{action:action,obj:obj},function(data){        var aObj = JSON.parse(data);        for (var i = 0; i < inputFieldsArray.length; i++) {            inputFieldsArray[i] == "BAFFLE_SEKECTOR_CLASS" ?                state1("."+inputFieldsArray[i]).val(aObj[inputFieldsArray[i]]).trigger("change"):                state1("#"+inputFieldsArray[i]).val(aObj[inputFieldsArray[i]]).trigger("change");        }        for (var i = 0; i < dataAttributesArray.length; i++) {            for (var j = 1; j <= 5; j++) {                if (dataAttributesArray[i] == "material_"+j+"_type" && aObj[dataAttributesArray[i]+"1"] != "") {                    if (j != 1) frame1.nmaterials.addMaterialBtn();                    frame1.nmaterials.SelectMaterialEnd(aObj[dataAttributesArray[i]+"1"],j);                }                if (dataAttributesArray[i] == "material_"+j+"_type" && aObj[dataAttributesArray[i]+"2"] != "") {                    if (j != 1) frame2.nmaterials.addMaterialBtn();                    frame2.nmaterials.SelectMaterialEnd(aObj[dataAttributesArray[i]+"2"],j);                }                if (dataAttributesArray[i] == "material_"+j+"_type" && aObj[dataAttributesArray[i]+"3"] != "") {                    if (j != 1) frame3.nmaterials.addMaterialBtn();                    frame3.nmaterials.SelectMaterialEnd(aObj[dataAttributesArray[i]+"3"],j);                }            }            state1('*[data-group="' + state1("#NUMBER_OF_DUPLICATOR_ID").val() + '"]').attr('data-' + dataAttributesArray[i].replace(/_/g,"-"), aObj[dataAttributesArray[i]+'1']);            state2('*[data-group="' + state2("#NUMBER_OF_DUPLICATOR_ID").val() + '"]').attr('data-' + dataAttributesArray[i].replace(/_/g,"-"), aObj[dataAttributesArray[i]+'2']);            state3('*[data-group="' + state3("#NUMBER_OF_DUPLICATOR_ID").val() + '"]').attr('data-' + dataAttributesArray[i].replace(/_/g,"-"), aObj[dataAttributesArray[i]+'3']);        }    });}// воспроизвести состояние//